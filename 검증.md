    파일이 학습에 바로 들어갈 수 있는 형태인가? (구조/무결성)

    내용이 “유효한 동작 데이터”인가? (포즈/시간/노이즈/일관성)

아래는 실제로 10개 샘플 QC할 때 체크할 항목 리스트를 “필수/권장”으로 정리한 거야.
A. 파일/스키마 무결성 (필수)
1) 필수 키 존재

    states 존재

    timestamps 존재 (없으면 fps 또는 time step 정보라도 있어야 함)

    confidence 존재(권장 필수급)

    metadata 존재(최소 video_id/source/duration/fps/quality_score)

✅ 통과 기준(예시)

    states 없으면 즉시 Fail

    timestamps 없으면 Warn/Fail (학습 방식에 따라)

2) shape 정합성

    states shape: [T, 33, 3] (또는 [T, 33, 4]면 visibility 포함인지 확인)

    actions가 있으면: [T-1, A]

    confidence shape: [T] 또는 [T,33] (정의 명확히)

✅ 통과 기준

    T가 30 이상(최소 1초) 권장

    actions가 있으면 T-1 정확히 일치해야 함

3) dtype/NaN/Inf 검사

    float32/float16 등 일관성

    NaN/Inf 포함 여부

✅ 통과 기준

    NaN/Inf 있으면 Fail (혹은 보정 규칙 필요)

4) 범위 검사(정규화 여부 확인)

    정규화된 좌표면 보통:

        camera normalized: x,y in [0,1], z는 대략 [-?, ?]

        pelvis-centered metric: 값이 너무 크면 이상

    갑자기 값이 1e6, -1e6 이런 거면 오류

✅ 통과 기준(예시)

    |pos| 평균이 비정상적으로 크면 Fail

    x,y가 [0,1]로 설계됐는데 범위 밖이 많으면 Fail

B. 시간/연속성 품질 (필수)
5) 프레임 간 “점프(튀는 값)” 비율

    관절 좌표가 프레임 사이에 갑자기 크게 이동하면

        트래킹 끊김

        영상이 흔들림/가려짐

        MediaPipe 실패 가능성

✅ 지표(예시)

    jump_ratio = (프레임 간 이동량이 임계치 초과인 프레임 비율)

    임계치: 데이터 스케일에 맞춰 설정(정규화면 0.05~0.1 수준부터 시작)

✅ 통과 기준(예시)

    jump_ratio > 0.1 이면 Fail/Warn (너 명세에 10% 이하 목표)

6) 속도/가속도 분포 이상치

    vel = pos[t+1]-pos[t]

    acc = vel[t+1]-vel[t]

✅ 통과 기준

    vel/acc 상위 1%가 전체 분포에 비해 “과도하게 크면” 트래킹 이상 가능성 → Warn/Fail

7) 연속 추적 성공 구간 길이

    confidence가 낮은 구간이 길면 학습에 독

✅ 지표(예시)

    confidence < 0.5 인 연속 구간의 최대 길이

    “연속 10프레임 이상 손실” 같은 기준

✅ 통과 기준(예시)

    손실 연속 구간 > 10프레임 많으면 Fail/Warn

C. 포즈 의미 품질 (학습 유효성) (필수급)
8) “유효 관절 수” (프레임별)

    33개 관절 중 visibility/confidence가 기준 이상인 관절 개수

✅ 통과 기준(예시)

    평균 유효 관절 수 >= 20개(60%)

    주요 관절(어깨/팔꿈치/손목)은 더 엄격(예: 0.6 이상)

9) 신체 스케일/골격 길이 일관성

    같은 사람이라면 팔 길이 같은 bone length가 큰 폭으로 변하면 이상

✅ 지표(예시)

    어깨-팔꿈치, 팔꿈치-손목 길이의 표준편차

    pelvis-centered 이후에도 bone length 변동이 크면 Fail/Warn

10) 포즈가 “정상적인 인간 형태”인지 (간단 규칙)

    손이 머리보다 10m 위로 튀는 등 불가능한 형태

    좌우가 바뀌거나, 관절 순서가 섞이는 오류

✅ 통과 기준

    규칙 기반 sanity check 몇 개만 넣어도 효과 큼

D. Action 품질 (actions가 있을 때) (권장)
11) actions 값 분포/일관성

    Δpos가 대부분 0이면 “정지 영상”일 가능성

    Δpos가 너무 크면 트래킹 튐

✅ 통과 기준(예시)

    action L2 norm 평균이 너무 작거나 너무 크면 Warn/Fail

12) state-action 정합성

    actions = states[t+1]-states[t] 로 정의했으면 실제로 맞는지 샘플 체크

✅ 통과 기준

    재구성 오차가 작은지 확인(정확히는 정의에 따라)

E. 메타데이터/중복/데이터셋 위생 (샘플 10개라도 확인) (권장)
13) metadata 최소 필드

    video_id, source_url, fps, duration_sec, collection_date, quality_score, mediapipe_confidence

✅ 통과 기준

    빠진 필드가 많으면 운영 품질 낮아짐 → Warn

14) 중복 징후

    서로 다른 video_id인데 states가 거의 동일(해시/요약 통계가 같음)

    timestamps 동일 + states 동일 → 중복 저장 가능성

✅ 통과 기준

    near-duplicate 의심이면 큐/중복제거 로직 점검

10개 랜덤 샘플 QC 결과를 “한 눈에” 보이게 출력하는 항목(추천)

각 파일당 아래 8개만 뽑아도 운영이 쉬워져:

    T (프레임 수)

    NaN/Inf 여부

    pos 범위(min/max)

    평균 confidence

    유효 관절 평균 개수

    jump_ratio

    bone_length 변동(팔 길이 std)

    품질 판정(PASS/WARN/FAIL) + 사유

PASS/WARN/FAIL 판정 기준(너 명세에 맞춘 기본안)

    FAIL

        states 없음, shape 불일치

        NaN/Inf 존재

        평균 confidence < 0.5

        jump_ratio > 0.1

        평균 유효 관절 < 20

    WARN

        fps/metadata 누락

        confidence 0.5~0.6 사이

        jump_ratio 0.05~0.1

        bone length 변동 큼(트래킹 흔들림 의심)

    PASS

        위 조건 모두 충족

